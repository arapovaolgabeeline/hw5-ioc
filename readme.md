IN PROGRESS...
осталось дорефакторить еще 